> 그림으로 쉽게 배우는 운영체제 - 감자님 강의 참조

가상메모리 개요

컴퓨터마다 실제 메모리의 크기는 다르다.
만약 운영체제나 프로세스가 4GB메모리에서 동작하도록 만들어졌다면 이보다 작은 메모리를 가진 컴퓨터에서는 실행되지 않을 것이다.

가상메모리는 이런 문제를 완벽하게 해결했다.
프로세스는 운영체제 영역이 어디있는지 물리메모리의 크기가 얼마나 큰지 몰라도 된다.
즉 프로그래머는 물리메모리의 크기와 프로세스가 메모리에 어느위치에 올라가는지 신경쓰지 않고 0번지에서 시작된다고 생각하고 프로그래밍을 하면 된다.

프로세스는 메모리 관리자를 통해서 메모리에 접근한다.
프로세스의 입장에서는 물리메모리에 직접 접근할 일이 없고 메모리관리자에게 요청만 하면 된다.
메모리 관리자는 프로세스의 요청이 있으면 그에 맞는 물리 메모리로 연결시켜 준다.

가상메모리의 크기는 이론적으로는 무한대이지만 실제로는 물리 메모리 크기와 CPU비트 수 로 결졍된다.

만약 32bit CPU인 경우 표현할 수 있는 주소값은 2<sup>32</sup> 으로 대략 4GB정도 되고 가상메모리 크기도 똑같이 4GB이다.

32bit CPU인 경우 최대 메모리 크기가 4GB라고 했는데 운영체제를 포함해서 수 많은 프로세스들은 어떻게 실행시킬까요?

4GB를 차지하는 프로세스 5개와 운영체제를 실행시킨다고 가정해 보겠습니다. 그럼 운영체제를 제외하고도 적어도 20GB가 필요하다.
이럴 때 가상 메모리 시스템은 물리 메모리 내용의 일부를 하드메모리 내 스왑영역으로 옮기고 처리가 필요할 때 물리 메모리로 가져와 실행시키기 때문에 운영체제와 프로세스 5개를 전부 실행 시킬 수 있다.

메모리관리자는 물리메모리와 스왑영역을 합쳐서 프로세스가 사용하는 가상주소를 물리주소로 변환하는데 이것을 동적주소변환(Dynamic Address Translation)이라고 부른다.

동적 주소 변환을 거치면 프로세스는 마음대로 사용자 데이터를 물리 메모리에 배치할 수 있다.

메모리 관리자는 "물리 메모리를 어떻게 나눌지", "프로세스를 어디다 배치할지", "부족한 물리 메모리는 어떻게 처리할지"와 같은 문제를 처리해야 하기 때문에 복잡한 과정을 거친다. 

가상 메모리 시스템에서는 운영체제 영역을 제외한 나머지 영역을 일정한 크기로 나누어서 프로세스에게 할당하는데 할당하는 방식은 메모리 분할 방식과 마찬가지로 "가변 분할 방식"과 "고정 분할 방식"으로 나뉩니다. 

가상 메모리 시스템에서는 가변 분할 방식을 이용한 세크멘테이션, 고정 분할 방식을 이용한 페이징이라는 것이 있습니다. 세그멘테이션에는 외부 단편화와 같은 단점이 있고 페이징에는 내부 단편화와 같은 단점이 있기 때문에 이 단점을 보완한 세그멘테이션-페이징 혼용 기법을 사용한다. 

가상메모리 시스템에서 가상주소는 메모리나 스왑영역 한 곳 중에 위치한다.
메모리 관리자는 가상주소와 물리주소를 일대일 매핑 테이블로 관리한다.



