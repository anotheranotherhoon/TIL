> 그림으로 쉽게 배우는 운영체제 - 감자님 강의 참조

여러 프로세스가 서로 다른 프로세스의 작업을 기다리다가 아무도 작업을 진행하지 못하는 상태를 교착상태라고 한다.

교착상태가 발생하는 이유는 공유자원 때문이다.

만약 어떤 자원을 여러 개의 프로세스가 공유하지 않는 다면 교착상태는 발생하지 않는다.



교착상태의 필요조건
1. 상호배제
- 어떤 프로세스가 한 리소스를 점유했다면 그 리소스는 다른 프로세스에게 공유가 되면 안된다.
2. 비선점
- 프로세스 A가 리소스를 점유하고 있는데 프로세스B가 리소스를 빼앗을 수 없어야 한다.
3. 점유와 대기
- 어떤 프로세스가 리소스 A를 가지고 있는 상태에서 리소스 B를 원하는 상태여야 한다.
4. 원형 대기
- 점유와 대기를 하는 프로세스들의 관계가 원형을 이루고 있다는 것이다.
필요조건에서 한 가지라도 충족되지 않는다면 교착상태는 발생하지 않는다.

운영체제를 연구하는 사람들은 이걸 이요해서 교착상태를 예방하려고 했으나 제약이 많고 굉장히 비효율적이라 다른 방식을 연구해야 했다.

바로 교착상태에 빠졌을때 해결하는 방법이다.

데드락 해결

교착상태 해결방법으로 교착상태 회피라는 방법이 있다.

프로세스들에게 자원을 할당할 때 어느정도 자원을 할당해야 교착상태가 발생하는지 파악해서 교착상태가 발생하지 않는 수준의 자원을 할당한다.

교착상태 회피는 전체 자원의 수와 할당된 자원의 수를 기준으로 안정상태와 불안정상태로 나눈다.

운영상태는 최대한 안정상태를 유지하려고 자원할당을 한다.
불안정상태에 있더라도 무조건 교착상태에 빠지는게 아니라 교착상태에 빠질 확률이 증가한다.

운영체제는 프로세스들에게 자원을 할당하기 전에 자기가 가지고 있는 전체 자원의 수를 알고 있어야한다. 이를 시스템의 총 자원이라고 한다. 그리고 프로세스들은 각자 자기가 필요한 자원의 최대 숫자를 운영체제에게 알려줘야한다. 이를 최대 요구자원이라고 부른다.

교착상태에 빠졌는지 알아내는 두 가지 방법
첫 번째 방식 "가벼운 교착상태 검출"
타이머를 이용하여 프로세스가 일정시간동안 작업을 진행하지 않는다면 교착상태가 발생했다고 간주하고 교착상태를 해결한다.
교착상태를 해결하는 방법은 간단하다. 일정 시점마다 체크 포인트를 만들어 작업을 저장하고 타임아웃으로 교착상태가 발생했다면 마지막으로 저장했던 체크포인터로 롤백하는 것이다.

두 번째 방식 "무거운 교착상태 검출"
이 방식은 자원 할당 그래프를 이용하는데 현재 운영체제에서 프로세스가 어떤 자원을 사용하는지 지켜보고 교착상태가 발생했다면 해결한다. 순환구조가 생긴 부분을 강제 종료 시키고 체크포인트로 롤백한다.

이 방식은 운영체제가 지속적으로 자원 할당 그래프를 유지하고 검사해야 하기 때문에 오버헤드가 발생한다.
하지만 가벼운 교착상태 검출에서 발생할 수 있는 억울하게 종료되는 프로세스는 발생하지 않는다.