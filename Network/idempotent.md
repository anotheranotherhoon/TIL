## 멱등성
> 전산학이나 수학에서 사용하는 용어로 연산을 여러 번 적용하더라도 결과가 달라지지 않는 성질, 연산을 여러번 반복하여도 한 번만 수행된 것과 같은 성질을 의미한다. 

* HTTP메서드 중 POST를 제외한 나머지 HTTP메서드(GET, PUT, DELETE)를 사용하는 경우 멱등성이 유지되어야 한다. 

* 멱등성은 '요청의 효과'를 보고 판단한다. 

* 서버의 상태는 멱등성이 유지되어야 하는 경우 같은 행위를 여러 번 반복하더라도 같은 효과를 가져야 한다.

* 멱등성이 성립하지 않으면, 같은 행위를 여러 번 반복하는 경우 요청마다 다른 효과가 발생된다고 생각하면 된다.

* GET 메서드는 단지 리소스를 읽어 오는 행위를 의미하기에 아무리 여러번 수행해도 결과도 변경되지 않는다.

* PUT 메서드는 요청에 담긴 리소스로 기존 리소스를 그대로 대체한다. 따라서 PUT 메서드도 여러번 수행해도 요청에 담긴 리소스가 변하지 않는 이상 연산 결과가 동일하다.

* POST 메서드의 경우 리소스를 새롭게 생성하는 행위이기 때문에 여러번 수행하게 되면 매번 리소스가 생성되어 연산을 수행한 결과가 매번 달라진다.

* PATCH 메서드는 구현 방법에 따라 PUT 메서드 처럼 멱등성이 보장될 수도 있고, 보장되지 않을 수도 있다. PATCH 메서드는 PUT메서드 처럼 리소스를 대체하는 행위가 아니기 때문에 요청을 어떤 방식으로 상요하는지에 대한 제한이 특별히 없기 때문이다. 

```
// 기존 리소스
{
    id: 1,
    name: 'evan',
    age: 30,
},
PATCH users/1
{ age: 31 }
// 새로운 리소스
{
    id: 1,
    name: 'evan',
    age: 31, // 변경됨
},
```
---
```
PATCH users/1
{
    $increase: 'age',
    value: 1,
}
```
* 위 요청의 경우  $increase 필드의 값은 증가시키고 싶은 속성을 의미하고, value 필드의 값은 그 속성을 얼마나 증가시킬 것인지를 나타낸다.

* 이 경우 API가 호출될 때마다 에반의 나이는 1씩 증가하기 때문에 이 API는 멱등성을 보장하지 않는다.

* 따라서 PATCH 메소드는 API를 어떻게 구현하냐에 따라서 멱등성을 보장할 수도 있고 아닐 수도 있는 것이다.

>참고 [[ RESTful API] PUT과 PATCH의 차이 - 멱동성을 보장하는 PUT, 멱등성을 보장하지 않는 PATCH](https://oen-blog.tistory.com/211)